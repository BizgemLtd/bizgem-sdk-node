!function(){function BootstrapBpg(options){this.defaults=options,this.apiBaseUrl="https://api.bizgem.io",this.iframeBaseUrl="https://checkout.bizgem.io",this.apiUrl="",this.iframeUrl="",this.pendingCode="09",this.successCode="00",this.cancelCode="17",this.traceId=null,this.reference=null,this.publicKey=null}function validateParameters(defaults){let parametersValidation={fullName:defaults.fullName,email:defaults.email,phoneNumber:defaults.phoneNumber,amount:defaults.amount,reference:defaults.reference},errorList="",errorUrlParamBuilder={};for(let p in parametersValidation)parametersValidation[p]||(errorList+=p+" is required \n",errorUrlParamBuilder[p]=p+" is required"),"amount"===p&&parametersValidation[p]<0&&(errorList+=p+" cant be less than zero \n",errorUrlParamBuilder[p]=p+" cant be less than zero");if(defaults.email&&(validateEmail(defaults.email)?parametersValidation.email=defaults.email:(errorList+="Email is not valid \n",errorUrlParamBuilder.email="Email is not valid")),errorList.length>0){if("function"==typeof window[parametersValidation.callback]){let callback=evaluateFunction(parametersValidation.callback);callback.call(this,{code:"E00",message:"Missing Parameters",data:errorUrlParamBuilder},null)}else window.location.href=defaults.redirectUrl;return}initializeBpg(defaults).then(()=>{})}async function initializeBpg(parameters){let pg=new BootstrapBpg(parameters);pg.publicKey=parameters.publicKey,delete parameters.publicKey;let apiUrl=`${pg.apiBaseUrl}/inward/post-from-sdk`,response={};if(await apiPost(apiUrl,parameters,pg.publicKey).then(a=>{response=a}).catch(a=>console.error(a)),pg.traceId=response.traceId,pg.reference=response.reference,response.responseCode!==pg.successCode){pg.executeFunction(pg.defaults.onFailure,response);return}pg.iframeUrl=`${pg.iframeBaseUrl}/payment/${pg.traceId}/${pg.reference}`,pg.defaults.enableFrame?pg.loadIframe(parameters):window.location.href=pg.iframeUrl}function showLoader(){this.div=document.createElement("div"),this.div.id="bpg-loader-component",this.innerDiv=document.createElement("div"),this.innerDiv.id="bpg-loader-inner-component",this.innerDiv.setAttribute("style","display:flex;justify-content: center;align-items: center;width: 100%;top: 0;left: 0;bottom: 0;right: 0;height: 100%;z-index: 1000000000;position: absolute;background-color: rgba(187,220,255,0.51);"),this.span=document.createElement("span"),this.span.id="bpg-loader-span-component",this.span.setAttribute("style","display: inline-block;width: 2rem;height: 2rem;vertical-align: text-bottom;border: 0.25em solid #3F88C5;border-right-color: transparent;border-radius: 50%;-webkit-animation: spinner-border 0.75s linear infinite;animation: spinner-border 0.75s linear infinite;"),this.div.insertAdjacentHTML("beforeend","<style>@keyframes spinner-border {to { transform: rotate(360deg);}}</style>"),this.innerDiv.appendChild(this.span),this.div.appendChild(this.innerDiv),document.body.appendChild(this.div)}function hideLoader(){document.getElementById("bpg-loader-component").remove()}async function apiPost(url="",data={},auth){showLoader();let response=await fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:auth},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(data)});return hideLoader(),response.json()}function evaluateFunction(string){try{return eval(string)}catch(err){return string}}function validateEmail(email){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(email).toLowerCase())}window.BPG={pay:function(a){let b={fullName:a.fullName||null,buttonId:a.buttonId||"bpg-button",email:a.email||null,phoneNumber:a.phoneNumber||null,amount:a.amount||null,narration:a.narration||null,logo:a.logo||null,redirectUrl:a.redirectUrl||window.location.href,reference:a.reference||null,publicKey:a.publicKey||null,enableFrame:a.enableFrame||!0,generateButton:a.generateButton||!1,onCancel:a.onCancel,onFailure:a.onFailure,onSuccess:a.onSuccess};a.generateButton?this.createButton():validateParameters(b)}},BootstrapBpg.prototype.listenForCloseEvent=function(){let a=document.getElementById("bpg-frame-component"),b=this;a&&(a.onload=async function(){if(this.contentWindow.location){if(this.contentWindow.location.toString().includes(b.iframeBaseUrl))return;b.closeIframe();let c={},a={traceId:b.traceId,reference:b.reference},d=`${b.apiBaseUrl}/inward/tsq`;await apiPost(d,a,b.publicKey).then(a=>{c=a}).catch(a=>console.error(a)),c.responseCode===b.successCode?b.executeFunction(b.defaults.onSuccess,a):c.responseCode===b.cancelCode&&b.executeFunction(b.defaults.onCancel,a)}})},BootstrapBpg.prototype.loadIframe=function(){this.div=document.createElement("div"),this.div.id="bpg-frame-component-container",this.div.setAttribute("style","-webkit-overflow-scrolling: touch; overflow-y: scroll; position:fixed; left: 0; right: 0; bottom: 0; top: 0px; z-index: 1000000000;"),this.iframe=document.createElement("iframe"),this.iframe.src=this.iframeUrl,this.iframe.id="bpg-frame-component",this.iframe.setAttribute("style","z-index: 2147483647;display: block;border: 0px none transparent; overflow-x: hidden; overflow-y: auto; visibility: visible; margin: 0px; padding: 0px; -webkit-tap-highlight-color: transparent; width: 100%; @media only screen and (max-width: 600px) {margin-bottom: 30%}; height: 110%"),this.iframeOpen=!0,this.div.appendChild(this.iframe),document.body.appendChild(this.div),this.listenForCloseEvent()},BootstrapBpg.prototype.closeIframe=function(){this.iframeOpen&&(this.iframe.style.display="none",this.iframe.style.visibility="hidden",this.iframeOpen=!1,document.body.style.overflow="")},BootstrapBpg.prototype.executeFunction=function(b,c){let a=document.getElementById("bpg-frame-component-container");a&&a.parentNode.removeChild(a),"undefined"!=typeof event&&event.data&&delete event.data.eventInstance,b&&b(c),this.closeIframe()},BootstrapBpg.prototype.createButton=function(){let a=this,b=document.getElementById(a.defaults.buttonId),c="bpg_trigger"+a.defaults.buttonId;b.innerHTML='<input  style="width:'+a.defaults.buttonSize+'px" id="'+c+'" class="bpg_trigger" type="button" value="Pay With BPG">',b.addEventListener("click",function(){return a.loadIframe(),!1})}}()